<!DOCTYPE html>
<html class="light" lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>Login | ProjectPulse AI</title>

    <link rel="icon" type="image/png" sizes="32x32" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAA35JREFUWEetl0toFGUYx3/fzO7O7uwm2U2zaRoatA1qFVq0kF6KF1A8KHgTPCh4KXgQvCh4UfAiFAUBQVAvFcFbpVi12gZsqUih2l6stJC2ySZNs7ub3c3OfM9/s5vdzG52d8P6h+Ewz3d7f8/7f8/7Pu8H/ucQ/jPgc0XjctD51/vUML8BoJVSqqcoqo9lWf2VUmlVVO8BfVpK7P+E/lcBXT05nI4d6vFy4UMsyzIymUx7NBr9zDTN8wA7gY1KqYuZTOb3ZDL5OcC2lhqUZbUHmAR2KqUe5PP532Kx2NcAbVZjs1HXl0qlZ7PZ7I0VK1a85nmet2XLlg+Ac4vWZwvwF8DBRqOj0WiP7/sX2tvbj3ieZ/f29r4FjC1VwH8F8DwvnM/n/+zu7n7fNE2rq6vrE+DS/0KAVQFM07R838/lcrm9wNdaa61pmnY4HD4IfL9UAv8UoK2t7Vkul3vQaDQ+lWU5vH79+o+Bq1rr+ZoQIWvtE2DfUgk0BaBUKg1ms9nbq1atOmIYhjU4OPgJcHMRglrrCeCdpRJoCqCUygB7hBDxcrn8w8DAwAeO4+jBwcHvgb+01n6j0QoAz5dK4f8CBINBLMsqF4vFbw3D0EKIyNatW48C55VSSmvtNxr1gSX/J2AJMBwOh4dKpdLzcrn8BeC3t7cfAf4E7i7wqGftUUrVm/2vSgBwN2zY8FI+nz9XKpVOaK2dQCDwAbVYvwJ8YVnWg1Kp9FQkEtnd09NzXEp5bWpq6hzAunXrVgC31q1bNwys0VpPr1279qNSqXShXC6/q7W2e3p6DgF/WJZVKZVKd9ra2t6zLMuqVCrTqVTqK+CFZVnFYrH4UyAQeMu27UAoFDoI/GpZ1uNSqfR3MBh8y7IsWSqVppPJ5BeGYcihoaF9wB+WZf1dKpV+DQQC+23bNnK53N2pqakjwLplA1y7di2Vz+cPFAqFqUAg8KbW2l23bt2HwO9SynvZbPZUIBB4y3VdwzRNz3Xd05ZlGc3CH2h0B6WU+fl8/pZt2/tc1zU9z3NnZmbOZDKZE1LKVa2trcOWZdXr/cFg8BXbtg3P82ZmZmbOZrPZE1LKvtra2h2WZUmA6enpC8Fg8C3XdU3P8+zZ2dnL2Wz2eyllVzgc3iWEGAfmA4FAoM+2bcO27dl0On0xm81+L6Xsli3MMYRCIaGUyuRyucu2be9zXdf0PM+enZ29nM1mv5dSdkcikXeFEGOtra2bgi3MEQqFhOu6pZxKpX61bXuf67qm67p2JpO5kM1mT0gpI+3t7duFEGNtbW0bgy3MMRwOC6WUlc/nb9u2vdd1XdN1XSedTv+SzWZPSClXt7e3Dwshxtra2gZaK2E4HBZKKSufz9+2bXuP67qm4zheOp2+mM1mT0opI+3t7W8JIcba2to2tFbC/wH+AbQff33j5Fb3AAAAAElFTkSuQmCC">
    <link rel="icon" type="image/png" sizes="16x16" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAkpJREFUOE+lU0toU0EUPXOzaVObFgxWK41aKkoVdSGC4MqFGxcu3LhwI7hQ0I0rFy5cCIILFy4EQVy4EEQQBEXBjYKiFq0IilpFa61JmybN4/veJE2bvE5C2wMf8zHz3j1z7r1vBvA/p/A3wW0y4dXzfNp1q2OO0/sS2H8a2P7N+H6AF0K0V+T0MwB3AUxGItFm4O0K0hU1gBkAvQB6o9HozUQicS0ajV6KxWLdgUDAi8VidwC8qDH0EkCvYRgL2Wz2RTwev2TbtjU2NvYAwM/aBicA9BmG8TWbzT5LJBKXHcdpTSaTdwD8Wq4yD2AQQD+AWi6Xe5ZKpS4qpbqy2ex9AD+rCf4GMAxgAMByLpd7mU6nLyqlDmaz2QcAflQR/ArgKYBhAOV8Pv9mZmamL5FI9JRKpQczMzOPAPxYIvgGwAiAEQDlQqHwNp1O9yWTSa9QKDycmZl5DOD7IsEkgNcARgGUC4XC23Q63ZdKpSqFQuFhNpt9DODbAsEPAG8AjAFQhULhbTqd7kulUqJQKDzMZrOPAXxdIPgF4C2AcQCqWCi8S6fTfclUShSLxUfZbPYJgM8LBH8AeAtgAoASxWJxPp1O96VSKVEqlaay2exjAJ8WCP4C8A7AJIByqVSaT6fTfT6fT5TL5fepVOoJgE8LBKsA3gP4AEAuFW5jY+MAVgF8APARgFwun8/n8/2nUilRLpcnU6nUJICPCwRrAH4BmANQLpfL8/n8fV8qlVClUvmdSqUmAXxYJ1gH8BvAPIClUqk8n0qlfX6/X2iaVs5kMh8ymcxTAO/XEawDqAD4DWC+XC7Pp1Ipn23bolarVfL5/Hwmk3kK4F2dwFqNq5VKZT6VSvls2xa1Wq2Sz+fnM5nMUwDv1gSsUOzaZrVa9fl8Pp/P5/P5fD6fz+fz+Xw+n8/n8/l8Pp/P5/P5fD6fz+fz+Xw+n8/n8/l8Pp/P5/P5fD6fz+fz+Xw+n8/n8/l8Pp/P5/P5fD6fz+fz+Xw+n8/n8/l8Pp/P5/P5fD6fz+fz+Xw+n8/n8/l8Pp/P5/P5fD6fz+fz+Xw+n8/n8/l8Pp/P5/P5fD6fz/f/8A9bA+R+mLIIVAAAAABJRU5ErkJggg==">
    <link rel="apple-touch-icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAABVVJREFUaEPtmW1oVWUYx3/3nJ3pXHtrbrncZfYy14ciIiuQggpKKAqKPoSCUVAQBRV90KcI8kMURUEQ9CGCoO9BUUFRRgVShH1wTbemW26W61y2ue7c7m6vp3vPuc5zns627p57iAP3wznnPM9z7v/1v/7Pc57nORr8j4f2f7z+P7l8zQPQarW6RCIxPTg4eK9pmg3Nzc0bNE2bikajZzVNS6nV6gMAWn19fQDA1NTU9L59+54RQui6rnd2dr4I4Fy1A9R0gI6Ojh3JZPLj+vr6N3VdN5qamt4BcH58fPwtrWw6RkdHXwHwxR1F0+l03NLSEk4kEueDweCzTU1N7wI4d60CqDlAIpFYB2C3pmnxTqfz3Xg8fr6lpaWttbX1QwDn5ufnFwC0mKZZTyQSU7lc7nggEHjDNE2jvb39QwDn0un0Yl1d3XNCCF3TtOlYLHY4HA6/bdu2rq7uNQATmqYtZLPZI52dnW+Zpqnrur5m9+7dH5fL5fz4+PiL5Qqk0+k4wBkA7UIIEYvFjodCobdN09R1XV+zZ8+ej8rl8p/x8fHufw9gmiYAhBDCarV+F4lE3jQMQ9d1XW9ubn4PwJ9jY2N7/i4wPj6+E8BpAFq1AL1e72cikUhbqVSqaJpWbG5u/hDAqZGRkb0A4vF43M/n+71er5umaWqaVhJCmJ2dne8DODk8PLwvHo/H/X6/3+v1ummamqYVhRBaV1fXewBODA8P749EIqFgMOj1er1umqamaUUhRLGzs/NdACdGRkZei0ajwWAw4PV6vW6apqZpRSGE1dXVtR/AiZGRkTei0WgoFAp4vV6vm6apaVpRCFHs6up6B8CJ0dHRt6LRaDgcDnq9Xq+bpqlpWlEIYXd3d78N4MTo6Ojb0Wg0EomEvF6v101T07SiEMLu6enZBuDE6OjoO9FoNBqNRrxer9dNU9O0ohCisbPzbQAnxsbG3hVCxGKxmNfr9bppappWFELYPb29WwH8ND4+vk8IEYvFYl6v1+umqWlaUQhh9/b2bgHw08TExD4hRCwWi3m9Xq+bpqZpRSGE3dfXtxnAzxMTE+8JIWKxWMzr9XrdNDVNKwoh7P7+/k0AftY0bZ8Qwo7FYl6v1+umqWlaUQhhDwxs3AjgF03T3hdC2LFYzOv1et00NU0rCiHswcHBDQB+1TTtAyGEHYvFvF6v101T07SiEMIeGhpaD+BXTdM+FELYsVjM6/V63TQ1TSsKIeyhoaF1AH7TNO1DIYQdi8W8Xq/XTVPTtKIQwh4eHl4L4Lhpmh8JIexYLKZpWtHr9XrdNDVNKwoh7JGREQDHLcvaL4SwY7FYLBqNet00NU0rCiHskZERAMdN0/xICGHHYrFYLNYGYFJrcQbGx8d3ApgEsNq27c+i0ehrpmmKQCCwTggxPTc3920gEHhD1/WSpmnG+vXrP5JS/jE9Pf0FgA4hREnTNH39+vUfSSnPzczMfA2gUwihhBDmzMzM10KIk7ZtNwP4p1wuzwOYXbVq1VtCCHPTpk3bAZybm5v72maz2U3TNFdN09Q0rSSlNLq6uvYDOD8/P/9NOBx+07Ztva2t7X0AF2zbLpmm2eT1es9PTU19ZVnW/UKILy3L+t62bW16enon/ymFQqGfhRCRFStWvC6E0DRNM/r7+78ql8v54eHhV5YjEI/HVwO4pGlaXgjR2NjY5nK5nBseHn5F07S8EGI5gGg0+r8A/gWzB3N+yt6a2gAAAABJRU5ErkJggg==">
    
    <!-- Alternative favicon using SVG (modern browsers) -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath d='M36.7273 44C33.9891 44 31.6043 39.8386 30.3636 33.69C29.123 39.8386 26.7382 44 24 44C21.2618 44 18.877 39.8386 17.6364 33.69C16.3957 39.8386 14.0109 44 11.2727 44C7.25611 44 4 35.0457 4 24C4 12.9543 7.25611 4 11.2727 4C14.0109 4 16.3957 8.16144 17.6364 14.31C18.877 8.16144 21.2618 4 24 4C26.7382 4 29.123 8.16144 30.3636 14.31C31.6043 8.16144 33.9891 4 36.7273 4C40.7439 4 44 12.9543 44 24C44 35.0457 40.7439 44 36.7273 44Z' fill='%23137fec'/%3E%3C/svg%3E">
    
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet"/>
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#137fec",
                        "background-light": "#f8fafc",
                        "background-dark": "#0f172a",
                        "secondary": "#0ea5e9",
                    },
                    fontFamily: {
                        "display": ["Inter", "sans-serif"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.375rem",
                        "lg": "0.5rem",
                        "xl": "0.75rem",
                        "2xl": "1rem",
                        "full": "9999px"
                    },
                },
            },
        }
    </script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }
        .bg-grid-pattern {
            background-image: radial-gradient(circle, #e2e8f0 1px, transparent 1px);
            background-size: 32px 32px;
        }
        .dark .bg-grid-pattern {
            background-image: radial-gradient(circle, #1e293b 1px, transparent 1px);
        }
        .policy-modal, .forgot-modal, .otp-modal, .join-team-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }
        .policy-modal.active, .forgot-modal.active, .otp-modal.active, .join-team-modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .mobile-menu {
            display: none;
            position: fixed;
            top: 64px;
            left: 0;
            width: 100%;
            background: white;
            border-bottom: 1px solid #e2e8f0;
            z-index: 999;
        }
        .dark .mobile-menu {
            background: #0f172a;
            border-color: #1e293b;
        }
        .mobile-menu.active {
            display: block;
        }
        @media (max-width: 640px) {
            .container-padding {
                padding: 1rem;
            }
        }
        .loading-spinner {
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .error-message {
            color: #ef4444;
            font-size: 0.75rem;
            margin-top: 0.25rem;
            display: none;
        }
        .success-message {
            color: #10b981;
            font-size: 0.75rem;
            margin-top: 0.25rem;
            display: none;
        }
        .info-message {
            color: #3b82f6;
            font-size: 0.75rem;
            margin-top: 0.25rem;
            display: none;
        }
        .account-not-exist {
            background: linear-gradient(135deg, #fef3c7, #ffedd5);
            border: 1px solid #fbbf24;
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            display: none;
            box-shadow: 0 10px 15px -3px rgba(245, 158, 11, 0.1);
        }
        .dark .account-not-exist {
            background: linear-gradient(135deg, #451a03, #422006);
            border-color: #b45309;
            box-shadow: 0 10px 15px -3px rgba(180, 83, 9, 0.2);
        }
        .account-not-exist .icon {
            background: #fbbf24;
            color: #fff;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1rem;
        }
        .dark .account-not-exist .icon {
            background: #b45309;
        }
        .account-not-exist h4 {
            color: #92400e;
            font-size: 1.125rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        .dark .account-not-exist h4 {
            color: #fcd34d;
        }
        .account-not-exist p {
            color: #b45309;
            margin-bottom: 1.25rem;
        }
        .dark .account-not-exist p {
            color: #fde68a;
        }
        .account-not-exist .create-account-btn {
            background: #d97706;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s;
            border: none;
            cursor: pointer;
            text-decoration: none;
        }
        .account-not-exist .create-account-btn:hover {
            background: #b45309;
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(217, 119, 6, 0.3);
        }
        .dark .account-not-exist .create-account-btn {
            background: #f59e0b;
            color: #000;
        }
        .dark .account-not-exist .create-account-btn:hover {
            background: #d97706;
        }
        /* Fix for checkbox visibility */
        #understandCheckbox {
            width: 1rem;
            height: 1rem;
            border: 2px solid #cbd5e1;
            border-radius: 0.25rem;
            background-color: white;
            cursor: pointer;
        }
        .dark #understandCheckbox {
            border-color: #4b5563;
            background-color: #1f2937;
        }
    </style>
</head>
<body class="bg-background-light dark:bg-background-dark font-display min-h-screen flex flex-col">
    <!-- Policy Modal -->
    <div id="policyModal" class="policy-modal">
        <div class="bg-white dark:bg-slate-800 rounded-2xl shadow-2xl max-w-2xl w-full mx-4 max-h-[80vh] overflow-y-auto">
            <div class="p-6">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-xl font-bold text-slate-900 dark:text-white">Privacy & Terms Summary</h3>
                    <button onclick="closePolicyModal()" class="text-slate-400 hover:text-slate-600 dark:hover:text-slate-300">
                        <span class="material-symbols-outlined">close</span>
                    </button>
                </div>
                <div class="space-y-4">
                    <div class="bg-green-50 dark:bg-green-900/20 p-4 rounded-lg">
                        <h4 class="font-semibold text-green-800 dark:text-green-300 mb-2">Key Commitments:</h4>
                        <ul class="space-y-2 text-sm text-green-700 dark:text-green-400">
                            <li class="flex items-start gap-2">
                                <span class="material-symbols-outlined text-sm mt-0.5">check_circle</span>
                                <span>We never sell your personal data</span>
                            </li>
                            <li class="flex items-start gap-2">
                                <span class="material-symbols-outlined text-sm mt-0.5">check_circle</span>
                                <span>Your code stays private - we only analyze metadata</span>
                            </li>
                            <li class="flex items-start gap-2">
                                <span class="material-symbols-outlined text-sm mt-0.5">check_circle</span>
                                <span>You own all your data</span>
                            </li>
                            <li class="flex items-start gap-2">
                                <span class="material-symbols-outlined text-sm mt-0.5">check_circle</span>
                                <span>30-day data deletion upon cancellation</span>
                            </li>
                            <li class="flex items-start gap-2">
                                <span class="material-symbols-outlined text-sm mt-0.5">check_circle</span>
                                <span>Enterprise-grade security (SOC 2 compliant)</span>
                            </li>
                        </ul>
                    </div>
                    <div class="text-sm text-slate-600 dark:text-slate-400 space-y-3">
                        <p>By signing in, you agree to our complete <a href="#" class="text-primary font-semibold hover:underline">Terms of Service</a> and <a href="#" class="text-primary font-semibold hover:underline">Privacy Policy</a>.</p>
                        <p>ProjectPulse AI analyzes repository metadata (commit history, PR data, issue tracking) to provide engineering insights. We do not access or store your actual source code content.</p>
                        <div class="pt-4 border-t border-slate-200 dark:border-slate-700">
                            <label class="flex items-start gap-3 cursor-pointer">
                                <input type="checkbox" id="understandCheckbox" class="mt-1" />
                                <span class="text-sm text-slate-700 dark:text-slate-300">I understand that ProjectPulse AI will analyze repository metadata (not code content) to provide insights, and I can revoke access at any time.</span>
                            </label>
                        </div>
                    </div>
                </div>
                <div class="mt-6 flex justify-end gap-3">
                    <button onclick="closePolicyModal()" class="px-4 py-2 text-sm font-medium text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white">
                        Cancel
                    </button>
                    <button onclick="acceptPolicy()" class="px-4 py-2 bg-primary text-white text-sm font-medium rounded-lg hover:bg-primary/90">
                        I Accept
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Forgot Password Modal -->
    <div id="forgotModal" class="forgot-modal">
        <div class="bg-white dark:bg-slate-800 rounded-2xl shadow-2xl max-w-md w-full mx-4">
            <div class="p-6">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-xl font-bold text-slate-900 dark:text-white">Reset Password</h3>
                    <button onclick="closeForgotModal()" class="text-slate-400 hover:text-slate-600 dark:hover:text-slate-300">
                        <span class="material-symbols-outlined">close</span>
                    </button>
                </div>
                <div id="forgotStep1">
                    <p class="text-sm text-slate-600 dark:text-slate-400 mb-4">
                        Enter your registered email address. We'll send you a 6-digit OTP to reset your password.
                    </p>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-xs font-bold text-slate-700 dark:text-slate-300 uppercase tracking-wide mb-1.5">Email Address</label>
                            <input type="email" id="forgotEmail" placeholder="name@company.com" 
                                   class="h-11 w-full rounded-lg border border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-900/50 px-4 text-slate-900 dark:text-white text-sm focus:border-primary focus:ring-1 focus:ring-primary outline-none transition-all">
                            <div id="forgotEmailError" class="error-message"></div>
                        </div>
                    </div>
                    <div class="mt-6 flex justify-end gap-3">
                        <button onclick="closeForgotModal()" class="px-4 py-2 text-sm font-medium text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white">
                            Cancel
                        </button>
                        <button onclick="sendOTP()" class="px-4 py-2 bg-primary text-white text-sm font-medium rounded-lg hover:bg-primary/90">
                            Send OTP
                        </button>
                    </div>
                </div>
                <div id="forgotStep2" class="hidden">
                    <p class="text-sm text-slate-600 dark:text-slate-400 mb-4">
                        Enter the 6-digit OTP sent to your email and your new password.
                    </p>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-xs font-bold text-slate-700 dark:text-slate-300 uppercase tracking-wide mb-1.5">OTP Code</label>
                            <input type="text" id="otpCode" placeholder="123456" maxlength="6" 
                                   class="h-11 w-full rounded-lg border border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-900/50 px-4 text-slate-900 dark:text-white text-sm focus:border-primary focus:ring-1 focus:ring-primary outline-none transition-all">
                            <div id="otpError" class="error-message"></div>
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-slate-700 dark:text-slate-300 uppercase tracking-wide mb-1.5">New Password</label>
                            <input type="password" id="newPassword" placeholder="••••••••" 
                                   class="h-11 w-full rounded-lg border border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-900/50 px-4 text-slate-900 dark:text-white text-sm focus:border-primary focus:ring-1 focus:ring-primary outline-none transition-all">
                            <div id="passwordError" class="error-message"></div>
                        </div>
                    </div>
                    <div class="mt-6 flex justify-end gap-3">
                        <button onclick="backToStep1()" class="px-4 py-2 text-sm font-medium text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white">
                            Back
                        </button>
                        <button onclick="verifyOTP()" class="px-4 py-2 bg-primary text-white text-sm font-medium rounded-lg hover:bg-primary/90">
                            Reset Password
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- OTP Success Modal -->
    <div id="otpModal" class="otp-modal">
        <div class="bg-white dark:bg-slate-800 rounded-2xl shadow-2xl max-w-md w-full mx-4">
            <div class="p-6 text-center">
                <div class="mx-auto w-16 h-16 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center mb-4">
                    <span class="material-symbols-outlined text-3xl text-green-600 dark:text-green-400">check_circle</span>
                </div>
                <h3 class="text-xl font-bold text-slate-900 dark:text-white mb-2">Password Reset Successful!</h3>
                <p class="text-sm text-slate-600 dark:text-slate-400 mb-6">
                    Your password has been reset successfully. You can now log in with your new password.
                </p>
                <button onclick="closeOTPModal()" class="px-6 py-2 bg-primary text-white text-sm font-medium rounded-lg hover:bg-primary/90">
                    Continue to Login
                </button>
            </div>
        </div>
    </div>

    <!-- Join Team Modal -->
    <div id="joinTeamModal" class="join-team-modal">
        <div class="bg-white dark:bg-slate-800 rounded-2xl shadow-2xl max-w-md w-full mx-4">
            <div class="p-6">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-xl font-bold text-slate-900 dark:text-white">Join a Team</h3>
                    <button onclick="closeJoinTeamModal()" class="text-slate-400 hover:text-slate-600 dark:hover:text-slate-300">
                        <span class="material-symbols-outlined">close</span>
                    </button>
                </div>
                <p class="text-sm text-slate-600 dark:text-slate-400 mb-6">
                    Enter your company code to join an existing team workspace.
                </p>
                <div class="space-y-4">
                    <div>
                        <label class="block text-xs font-bold text-slate-700 dark:text-slate-300 uppercase tracking-wide mb-1.5">Company Code</label>
                        <input type="text" id="companyCode" placeholder="ABC123456" 
                               class="h-11 w-full rounded-lg border border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-900/50 px-4 text-slate-900 dark:text-white text-sm focus:border-primary focus:ring-1 focus:ring-primary outline-none transition-all"
                               maxlength="9">
                        <div id="companyCodeError" class="error-message"></div>
                        <p class="text-xs text-slate-500 dark:text-slate-400 mt-2">
                            Format: ABC123456 (3 letters + 6 numbers)
                        </p>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-slate-700 dark:text-slate-300 uppercase tracking-wide mb-1.5">Your Email</label>
                        <input type="email" id="joinEmail" placeholder="you@company.com" 
                               class="h-11 w-full rounded-lg border border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-900/50 px-4 text-slate-900 dark:text-white text-sm focus:border-primary focus:ring-1 focus:ring-primary outline-none transition-all">
                        <div id="joinEmailError" class="error-message"></div>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-slate-700 dark:text-slate-300 uppercase tracking-wide mb-1.5">Full Name</label>
                        <input type="text" id="joinName" placeholder="John Doe" 
                               class="h-11 w-full rounded-lg border border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-900/50 px-4 text-slate-900 dark:text-white text-sm focus:border-primary focus:ring-1 focus:ring-primary outline-none transition-all">
                        <div id="joinNameError" class="error-message"></div>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-slate-700 dark:text-slate-300 uppercase tracking-wide mb-1.5">Position</label>
                        <select id="joinPosition" class="h-11 w-full rounded-lg border border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-900/50 px-4 text-slate-900 dark:text-white text-sm focus:border-primary focus:ring-1 focus:ring-primary outline-none transition-all">
                            <option value="">Select your position</option>
                            <option value="Developer">Developer</option>
                            <option value="Team Lead">Team Lead</option>
                            <option value="Project Manager">Project Manager</option>
                            <option value="QA Engineer">QA Engineer</option>
                            <option value="DevOps">DevOps</option>
                            <option value="Designer">Designer</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                </div>
                <div class="mt-6 flex justify-end gap-3">
                    <button onclick="closeJoinTeamModal()" class="px-4 py-2 text-sm font-medium text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white">
                        Cancel
                    </button>
                    <button onclick="joinTeam()" id="joinTeamBtn" class="px-4 py-2 bg-primary text-white text-sm font-medium rounded-lg hover:bg-primary/90">
                        Join Team
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile Menu -->
    <div id="mobileMenu" class="mobile-menu">
        <div class="p-4 space-y-4">
            <a href="/solutions" class="block py-2 text-slate-600 dark:text-slate-400 hover:text-primary transition-colors">Solutions</a>
            <a href="/docs" class="block py-2 text-slate-600 dark:text-slate-400 hover:text-primary transition-colors">Documentation</a>
            <a href="/support" class="block py-2 text-slate-600 dark:text-slate-400 hover:text-primary transition-colors">Support</a>
            <div class="pt-2 border-t border-slate-200 dark:border-slate-800">
                <button onclick="showContactForm()" class="w-full py-2 text-sm font-semibold text-primary hover:text-primary/80">Contact Sales</button>
            </div>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="sticky top-0 z-50 w-full border-b border-slate-200 dark:border-slate-800 bg-white/80 dark:bg-slate-900/80 backdrop-blur-md">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
            <div class="flex items-center gap-2">
                <div class="size-8 text-primary">
                    <svg fill="none" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
                        <path d="M36.7273 44C33.9891 44 31.6043 39.8386 30.3636 33.69C29.123 39.8386 26.7382 44 24 44C21.2618 44 18.877 39.8386 17.6364 33.69C16.3957 39.8386 14.0109 44 11.2727 44C7.25611 44 4 35.0457 4 24C4 12.9543 7.25611 4 11.2727 4C14.0109 4 16.3957 8.16144 17.6364 14.31C18.877 8.16144 21.2618 4 24 4C26.7382 4 29.123 8.16144 30.3636 14.31C31.6043 8.16144 33.9891 4 36.7273 4C40.7439 4 44 12.9543 44 24C44 35.0457 40.7439 44 36.7273 44Z" fill="currentColor"></path>
                    </svg>
                </div>
                <span class="text-slate-900 dark:text-white text-lg font-bold tracking-tight">ProjectPulse AI</span>
            </div>
            <div class="hidden md:flex items-center gap-8">
                <a href="/solutions" class="text-sm font-medium text-slate-600 dark:text-slate-400 hover:text-primary transition-colors">Solutions</a>
                <a href="/docs" class="text-sm font-medium text-slate-600 dark:text-slate-400 hover:text-primary transition-colors">Documentation</a>
                <a href="/support" class="text-sm font-medium text-slate-600 dark:text-slate-400 hover:text-primary transition-colors">Support</a>
                <div class="h-4 w-px bg-slate-200 dark:border-slate-800"></div>
                <button onclick="showContactForm()" class="text-sm font-semibold text-primary hover:text-primary/80">Contact Sales</button>
            </div>
            <button onclick="toggleMobileMenu()" class="md:hidden text-slate-600 dark:text-slate-400">
                <span class="material-symbols-outlined">menu</span>
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="flex-1 flex items-center justify-center p-4 sm:p-6 bg-grid-pattern relative overflow-hidden">
        <div class="absolute inset-0 bg-gradient-to-b from-transparent via-background-light/50 to-background-light dark:via-background-dark/50 dark:to-background-dark pointer-events-none"></div>
        
        <div class="relative w-full max-w-6xl grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-0 bg-white dark:bg-slate-900 rounded-2xl shadow-xl sm:shadow-2xl shadow-slate-200 dark:shadow-none border border-slate-200 dark:border-slate-800 overflow-hidden">
            
            <!-- Left Column - Welcome Section -->
            <div class="flex flex-col justify-center p-6 sm:p-8 lg:p-12 xl:p-16 bg-gradient-to-br from-primary/5 to-secondary/5 dark:from-primary/10 dark:to-secondary/10 border-b lg:border-b-0 lg:border-r border-slate-200 dark:border-slate-800">
                <div class="max-w-md mx-auto w-full">
                    <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-primary/10 text-primary text-xs font-bold uppercase tracking-wider mb-6">
                        <span class="material-symbols-outlined text-xs">rocket_launch</span>
                        Welcome to ProjectPulse AI
                    </div>
                    <h2 class="text-3xl sm:text-4xl font-extrabold text-slate-900 dark:text-white mb-6 leading-[1.1]">Accelerate your engineering team.</h2>
                    <p class="text-slate-600 dark:text-slate-400 text-base sm:text-lg mb-8 leading-relaxed">
                        Get real-time insights into your team's productivity, project health, and delivery metrics.
                    </p>
                    
                    <!-- Feature List -->
                    <div class="space-y-4 mb-8">
                        <div class="flex items-start gap-3">
                            <div class="mt-1 bg-green-500/10 p-1 rounded">
                                <span class="material-symbols-outlined text-green-600 text-sm">check</span>
                            </div>
                            <p class="text-sm text-slate-600 dark:text-slate-400">Team performance dashboards and metrics</p>
                        </div>
                        <div class="flex items-start gap-3">
                            <div class="mt-1 bg-green-500/10 p-1 rounded">
                                <span class="material-symbols-outlined text-green-600 text-sm">check</span>
                            </div>
                            <p class="text-sm text-slate-600 dark:text-slate-400">PR review insights and bottleneck detection</p>
                        </div>
                        <div class="flex items-start gap-3">
                            <div class="mt-1 bg-green-500/10 p-1 rounded">
                                <span class="material-symbols-outlined text-green-600 text-sm">check</span>
                            </div>
                            <p class="text-sm text-slate-600 dark:text-slate-400">Sprint planning and forecasting tools</p>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="flex flex-col sm:flex-row gap-3">
                        <a href="register-company.html" class="flex-1 px-6 h-12 bg-slate-900 dark:bg-white text-white dark:text-slate-900 font-bold rounded-lg hover:opacity-90 transition-all flex items-center justify-center gap-2">
                            <span class="material-symbols-outlined">business</span>
                            <span>Create Company</span>
                        </a>
                        <button onclick="showJoinTeamModal()" class="flex-1 px-6 h-12 border-2 border-slate-300 dark:border-slate-700 text-slate-700 dark:text-slate-300 font-bold rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800 transition-all flex items-center justify-center gap-2">
                            <span class="material-symbols-outlined">group_add</span>
                            <span>Join Team</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Right Column - Login Section -->
            <div class="flex flex-col justify-center p-6 sm:p-8 lg:p-12 xl:p-16 bg-white dark:bg-slate-900">
                <div class="max-w-sm w-full mx-auto">
                    <div class="mb-6 sm:mb-8">
                        <h1 class="text-2xl font-bold text-slate-900 dark:text-white">Welcome Back</h1>
                        <p class="text-slate-500 dark:text-slate-400 text-sm mt-1">Sign in to your workspace</p>
                    </div>
                    
                    <!-- Account Not Exist Message - Enhanced Design -->
                    <div id="accountNotExist" class="account-not-exist hidden">
                        <div class="icon">
                            <span class="material-symbols-outlined text-2xl">info</span>
                        </div>
                        <h4>Account Not Found</h4>
                        <p>We couldn't find an account with this email address. Let's get you started!</p>
                        <a href="register-company.html" class="create-account-btn">
                            <span class="material-symbols-outlined">person_add</span>
                            Create Your Account Now
                        </a>
                        <div class="mt-4 text-sm">
                            <span class="text-amber-700 dark:text-amber-300">Already have a company code? </span>
                            <button onclick="showJoinTeamModal()" class="text-primary font-semibold hover:underline bg-transparent border-none p-0 inline">
                                Join your team
                            </button>
                        </div>
                    </div>
                    
                    <!-- Login Form -->
                    <form id="loginForm" class="space-y-4">
                        <div>
                            <label class="block text-xs font-bold text-slate-700 dark:text-slate-300 uppercase tracking-wide mb-1.5" for="email">Work Email</label>
                            <input class="h-11 w-full rounded-lg border border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-900/50 px-4 text-slate-900 dark:text-white text-sm focus:border-primary focus:ring-1 focus:ring-primary outline-none transition-all" 
                                   id="email" 
                                   placeholder="name@company.com" 
                                   type="email"
                                   required/>
                            <div id="emailError" class="error-message"></div>
                        </div>
                        <div>
                            <div class="flex justify-between items-center mb-1.5">
                                <label class="block text-xs font-bold text-slate-700 dark:text-slate-300 uppercase tracking-wide" for="password">Password</label>
                                <button type="button" onclick="showForgotModal()" class="text-xs font-semibold text-primary hover:underline">Forgot?</button>
                            </div>
                            <input class="h-11 w-full rounded-lg border border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-900/50 px-4 text-slate-900 dark:text-white text-sm focus:border-primary focus:ring-1 focus:ring-primary outline-none transition-all" 
                                   id="password" 
                                   placeholder="••••••••" 
                                   type="password"
                                   required/>
                            <div id="passwordError" class="error-message"></div>
                        </div>
                        <div class="flex items-center gap-2 pt-1">
                            <input class="size-4 rounded border-slate-300 text-primary focus:ring-primary" id="remember" type="checkbox"/>
                            <label class="text-xs text-slate-600 dark:text-slate-400" for="remember">Keep me signed in</label>
                        </div>
                        
                        <!-- Login Status Message -->
                        <div id="loginStatus" class="text-sm text-center p-2 rounded-lg hidden"></div>
                        
                        <button type="submit" id="loginButton" class="w-full h-11 bg-primary hover:bg-primary/90 text-white font-bold rounded-lg transition-all flex items-center justify-center gap-2 mt-4 shadow-lg shadow-primary/20">
                            <span>Sign In</span>
                            <span class="material-symbols-outlined text-sm">arrow_forward</span>
                        </button>
                    </form>

                    <!-- Quick Links -->
                    <div class="mt-6 pt-6 border-t border-slate-100 dark:border-slate-800">
                        <div class="grid grid-cols-2 gap-3">
                            <a href="register-company.html" class="text-center p-2 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors">
                                <span class="material-symbols-outlined text-primary block mx-auto mb-1">business</span>
                                <span class="text-xs font-medium text-slate-600 dark:text-slate-400">New Company</span>
                            </a>
                            <button onclick="showJoinTeamModal()" class="text-center p-2 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors">
                                <span class="material-symbols-outlined text-primary block mx-auto mb-1">group_add</span>
                                <span class="text-xs font-medium text-slate-600 dark:text-slate-400">Join Team</span>
                            </button>
                        </div>
                    </div>

                    <!-- Create Account Link (Mobile Friendly) -->
                    <div class="mt-4 text-center lg:hidden">
                        <p class="text-xs text-slate-500 dark:text-slate-400">
                            New to ProjectPulse? 
                            <a href="register-company.html" class="text-primary font-semibold hover:underline">Create account</a>
                        </p>
                    </div>

                    <!-- Terms -->
                    <div class="mt-6 text-center">
                        <p class="text-xs text-slate-500 dark:text-slate-400">
                            By signing in, you agree to our 
                            <a href="#" onclick="showPolicyModal(); return false;" class="text-slate-900 dark:text-white font-semibold hover:underline">Terms</a> and 
                            <a href="#" onclick="showPolicyModal(); return false;" class="text-slate-900 dark:text-white font-semibold hover:underline">Privacy Policy</a>.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="py-6 sm:py-8 px-4 sm:px-6 border-t border-slate-200 dark:border-slate-800">
        <div class="max-w-7xl mx-auto flex flex-col sm:flex-row items-center justify-between gap-4 text-[11px] font-bold text-slate-400 uppercase tracking-widest">
            <div class="flex flex-col sm:flex-row sm:gap-6 items-center gap-2">
                <span>© 2026 ProjectPulse AI</span>
                <a href="/status" class="flex items-center gap-1.5 hover:text-primary transition-colors">
                    <span class="size-1.5 rounded-full bg-green-500"></span>
                    All Systems Operational
                </a>
            </div>
            <div class="flex flex-wrap justify-center gap-4 sm:gap-6">
                <a href="/privacy" class="hover:text-primary transition-colors">Privacy</a>
                <a href="/terms" class="hover:text-primary transition-colors">Terms</a>
                <a href="/cookies" class="hover:text-primary transition-colors">Cookies</a>
                <a href="/security" class="hover:text-primary transition-colors">Security</a>
            </div>
        </div>
    </footer>

    <!-- JavaScript - Fixed Functionality -->
    <script>
        // API Configuration
        const API_BASE = 'http://localhost:3000';
        let pendingLogin = null;
        let currentForgotEmail = '';

        // Check if user is already logged in
        (function() {
            const token = localStorage.getItem('token');
            const user = localStorage.getItem('user');
            if (token && user) {
                // Redirect based on role
                const userData = JSON.parse(user);
                if (userData.role === 'admin') {
                    window.location.href = 'admin-dashboard.html';
                } else {
                    window.location.href = 'employee-dashboard.html';
                }
            }
        })();

        // Mobile menu
        function toggleMobileMenu() {
            const menu = document.getElementById('mobileMenu');
            menu.classList.toggle('active');
        }

        // Close mobile menu when clicking outside
        document.addEventListener('click', (e) => {
            const menu = document.getElementById('mobileMenu');
            const menuButton = document.querySelector('nav button.md\\:hidden');
            if (menu && menu.classList.contains('active') && 
                !menu.contains(e.target) && 
                menuButton && !menuButton.contains(e.target)) {
                menu.classList.remove('active');
            }
        });

        // ========== POLICY MODAL ==========
        function showPolicyModal() {
            document.getElementById('policyModal').classList.add('active');
        }

        function closePolicyModal() {
            document.getElementById('policyModal').classList.remove('active');
        }

        function acceptPolicy() {
            const checkbox = document.getElementById('understandCheckbox');
            if (!checkbox.checked) {
                alert('Please acknowledge our data usage policy to continue.');
                return;
            }
            closePolicyModal();
            
            // After accepting policy, perform login
            if (pendingLogin) {
                performLogin(pendingLogin.email, pendingLogin.password);
            }
        }

        // ========== JOIN TEAM MODAL ==========
        function showJoinTeamModal() {
            document.getElementById('joinTeamModal').classList.add('active');
        }

        function closeJoinTeamModal() {
            document.getElementById('joinTeamModal').classList.remove('active');
            // Clear form
            document.getElementById('companyCode').value = '';
            document.getElementById('joinEmail').value = '';
            document.getElementById('joinName').value = '';
            document.getElementById('joinPosition').value = '';
            clearErrors();
        }

        // ========== FORGOT PASSWORD MODAL ==========
        function showForgotModal() {
            document.getElementById('forgotModal').classList.add('active');
            document.getElementById('forgotStep1').classList.remove('hidden');
            document.getElementById('forgotStep2').classList.add('hidden');
            const emailFromLogin = document.getElementById('email').value;
            if (emailFromLogin) {
                document.getElementById('forgotEmail').value = emailFromLogin;
            }
            clearErrors();
        }

        function closeForgotModal() {
            document.getElementById('forgotModal').classList.remove('active');
            document.getElementById('forgotEmail').value = '';
            document.getElementById('otpCode').value = '';
            document.getElementById('newPassword').value = '';
            clearErrors();
        }

        function backToStep1() {
            document.getElementById('forgotStep1').classList.remove('hidden');
            document.getElementById('forgotStep2').classList.add('hidden');
            clearErrors();
        }

        function closeOTPModal() {
            document.getElementById('otpModal').classList.remove('active');
            closeForgotModal();
        }

        // ========== UTILITY FUNCTIONS ==========
        function clearErrors() {
            document.querySelectorAll('.error-message').forEach(el => {
                el.style.display = 'none';
                el.textContent = '';
            });
        }

        function showError(elementId, message) {
            const errorEl = document.getElementById(elementId);
            if (errorEl) {
                errorEl.textContent = message;
                errorEl.style.display = 'block';
            }
        }

        function showLoading(buttonId) {
            const btn = document.getElementById(buttonId);
            if (btn) {
                btn.disabled = true;
                btn.innerHTML = '<div class="loading-spinner rounded-full h-5 w-5 border-b-2 border-white mx-auto"></div>';
            }
        }

        function hideLoading(buttonId, originalText) {
            const btn = document.getElementById(buttonId);
            if (btn) {
                btn.disabled = false;
                btn.innerHTML = originalText || '<span>Sign In</span><span class="material-symbols-outlined text-sm">arrow_forward</span>';
            }
        }

        // Auto-uppercase company code
        document.getElementById('companyCode')?.addEventListener('input', function(e) {
            this.value = this.value.toUpperCase();
        });

        // ========== API FUNCTIONS ==========
        async function checkAccountExists(email) {
            try {
                const res = await fetch(`${API_BASE}/api/auth/check-email`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email })
                });
                const data = await res.json();
                return data.exists;
            } catch (error) {
                console.error('Error checking account:', error);
                return false;
            }
        }

        // ========== LOGIN FLOW ==========
        document.getElementById('loginForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const email = document.getElementById('email').value.trim();
            const password = document.getElementById('password').value;
            const remember = document.getElementById('remember').checked;
            
            clearErrors();
            document.getElementById('accountNotExist').classList.add('hidden');
            document.getElementById('loginStatus').classList.add('hidden');
            
            // Validate
            let hasError = false;
            if (!email) {
                showError('emailError', 'Email is required');
                hasError = true;
            }
            if (!password) {
                showError('passwordError', 'Password is required');
                hasError = true;
            }
            if (hasError) return;
            
            // Show loading
            const loginButton = document.getElementById('loginButton');
            const originalText = loginButton.innerHTML;
            showLoading('loginButton');
            
            try {
                // First check if account exists
                const exists = await checkAccountExists(email);
                
                if (!exists) {
                    // Account doesn't exist - show message
                    document.getElementById('accountNotExist').classList.remove('hidden');
                    hideLoading('loginButton', originalText);
                    return;
                }
                
                // Account exists - store credentials and show terms modal
                pendingLogin = { email, password, remember };
                showPolicyModal();
                hideLoading('loginButton', originalText);
                
            } catch (error) {
                console.error('Login error:', error);
                document.getElementById('loginStatus').textContent = 'Network error. Please try again.';
                document.getElementById('loginStatus').className = 'text-sm text-center p-2 rounded-lg bg-red-100 text-red-700';
                document.getElementById('loginStatus').classList.remove('hidden');
                hideLoading('loginButton', originalText);
            }
        });

        async function performLogin(email, password) {
            const loginButton = document.getElementById('loginButton');
            const originalText = loginButton.innerHTML;
            const remember = pendingLogin?.remember || false;
            
            showLoading('loginButton');
            
            try {
                const res = await fetch(`${API_BASE}/api/auth/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, password, remember })
                });
                
                const data = await res.json();
                
                if (res.ok) {
                    localStorage.setItem('token', data.token);
                    localStorage.setItem('user', JSON.stringify(data.user));
                    
                    document.getElementById('loginStatus').textContent = 'Login successful! Redirecting...';
                    document.getElementById('loginStatus').className = 'text-sm text-center p-2 rounded-lg bg-green-100 text-green-700';
                    document.getElementById('loginStatus').classList.remove('hidden');
                    
                    setTimeout(() => {
                        // Redirect based on user role
                        if (data.user.role === 'admin') {
                            window.location.href = 'admin-dashboard.html';
                        } else {
                            window.location.href = 'employee-dashboard.html';
                        }
                    }, 1500);
                } else {
                    document.getElementById('loginStatus').textContent = data.error || 'Login failed';
                    document.getElementById('loginStatus').className = 'text-sm text-center p-2 rounded-lg bg-red-100 text-red-700';
                    document.getElementById('loginStatus').classList.remove('hidden');
                    hideLoading('loginButton', originalText);
                }
            } catch (error) {
                console.error('Login error:', error);
                document.getElementById('loginStatus').textContent = 'Network error. Please try again.';
                document.getElementById('loginStatus').className = 'text-sm text-center p-2 rounded-lg bg-red-100 text-red-700';
                document.getElementById('loginStatus').classList.remove('hidden');
                hideLoading('loginButton', originalText);
            }
        }

        // ========== JOIN TEAM ==========
        async function joinTeam() {
            const companyCode = document.getElementById('companyCode').value.toUpperCase();
            const email = document.getElementById('joinEmail').value.trim();
            const fullName = document.getElementById('joinName').value.trim();
            const position = document.getElementById('joinPosition').value;
            
            clearErrors();
            
            // Validation
            let hasError = false;
            if (!companyCode) {
                showError('companyCodeError', 'Company code is required');
                hasError = true;
            } else if (!/^[A-Z]{3}\d{6}$/.test(companyCode)) {
                showError('companyCodeError', 'Company code must be 3 letters followed by 6 numbers (e.g., ABC123456)');
                hasError = true;
            }
            if (!email) {
                showError('joinEmailError', 'Email is required');
                hasError = true;
            } else if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
                showError('joinEmailError', 'Please enter a valid email address');
                hasError = true;
            }
            if (!fullName) {
                showError('joinNameError', 'Full name is required');
                hasError = true;
            }
            if (!position) {
                showError('joinNameError', 'Please select your position');
                hasError = true;
            }
            if (hasError) return;
            
            // Show loading on join button
            const joinBtn = document.getElementById('joinTeamBtn');
            const originalText = joinBtn.innerHTML;
            joinBtn.disabled = true;
            joinBtn.innerHTML = '<div class="loading-spinner rounded-full h-5 w-5 border-b-2 border-white mx-auto"></div>';
            
            try {
                // STEP 1: Check if company code exists
                const checkRes = await fetch(`${API_BASE}/api/companies/check-code/${companyCode}`);
                const companyData = await checkRes.json();
                
                if (!checkRes.ok) {
                    showError('companyCodeError', companyData.error || 'Invalid company code');
                    joinBtn.disabled = false;
                    joinBtn.innerHTML = originalText;
                    return;
                }
                
                // STEP 2: Check if email is already registered in ANY company
                const emailCheckRes = await fetch(`${API_BASE}/api/auth/check-email`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email })
                });
                
                const emailCheckData = await emailCheckRes.json();
                
                if (emailCheckData.exists) {
                    // Email is already registered - show message and close modal
                    closeJoinTeamModal();
                    
                    // Show a nice message
                    alert(`This email (${email}) is already registered in our system.\n\nPlease sign in with your existing account.`);
                    
                    // Pre-fill the email in login form
                    document.getElementById('email').value = email;
                    document.getElementById('password').focus();
                    
                    joinBtn.disabled = false;
                    joinBtn.innerHTML = originalText;
                    return;
                }
                
                // STEP 3: Generate a secure random password
                const tempPassword = generateSecurePassword();
                
                // STEP 4: Register team member
                const registerRes = await fetch(`${API_BASE}/api/auth/register-team`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        companyCode, 
                        email, 
                        fullName, 
                        position, 
                        password: tempPassword 
                    })
                });
                
                const registerData = await registerRes.json();
                
                if (registerRes.ok) {
                    // Save token and user data to localStorage
                    localStorage.setItem('token', registerData.token);
                    localStorage.setItem('user', JSON.stringify(registerData.user));
                    
                    // Show success message
                    alert(`✅ Successfully joined ${companyData.companyName}!\n\nYour temporary password is: ${tempPassword}\n\nYou will now be redirected to your dashboard.`);
                    
                    // Close modal
                    closeJoinTeamModal();
                    
                    // Redirect to employee dashboard (team members are always employees)
                    window.location.href = 'employee-dashboard.html';
                    
                } else {
                    // Check if error is because email already exists
                    if (registerData.error && registerData.error.includes('already registered')) {
                        showError('joinEmailError', 'This email is already registered in this company. Please login instead.');
                        
                        // Add a login button suggestion
                        setTimeout(() => {
                            if (confirm('Email already registered. Would you like to go to login?')) {
                                closeJoinTeamModal();
                                document.getElementById('email').value = email;
                                document.getElementById('password').focus();
                            }
                        }, 1000);
                    } else {
                        showError('joinEmailError', registerData.error || 'Failed to join team');
                    }
                    joinBtn.disabled = false;
                    joinBtn.innerHTML = originalText;
                }
            } catch (error) {
                console.error('Join team error:', error);
                alert('Network error. Please check your connection and try again.');
                joinBtn.disabled = false;
                joinBtn.innerHTML = originalText;
            }
        }

        // Generate secure random password
        function generateSecurePassword() {
            const length = 12;
            const charset = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*";
            let password = "";
            for (let i = 0; i < length; i++) {
                const randomIndex = Math.floor(Math.random() * charset.length);
                password += charset[randomIndex];
            }
            return password;
        }

        // ========== FORGOT PASSWORD ==========
        async function sendOTP() {
            const email = document.getElementById('forgotEmail').value.trim();
            clearErrors();
            
            if (!email) {
                showError('forgotEmailError', 'Please enter your email address.');
                return;
            }
            
            const sendBtn = document.querySelector('#forgotStep1 .bg-primary');
            const originalText = sendBtn.innerHTML;
            sendBtn.disabled = true;
            sendBtn.innerHTML = '<div class="loading-spinner rounded-full h-5 w-5 border-b-2 border-white mx-auto"></div>';
            
            try {
                const res = await fetch(`${API_BASE}/api/auth/forgot-password`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email })
                });
                
                const data = await res.json();
                
                if (res.ok) {
                    currentForgotEmail = email;
                    document.getElementById('forgotStep1').classList.add('hidden');
                    document.getElementById('forgotStep2').classList.remove('hidden');
                    setTimeout(() => document.getElementById('otpCode').focus(), 100);
                    
                    if (data.otp) {
                        console.log('OTP for testing:', data.otp);
                    }
                } else {
                    if (data.error === 'No account found with this email') {
                        showError('forgotEmailError', 'No account found with this email. Please create an account first.');
                    } else {
                        showError('forgotEmailError', data.error || 'Failed to send OTP');
                    }
                }
            } catch (error) {
                console.error('Error:', error);
                showError('forgotEmailError', 'Network error. Please try again.');
            } finally {
                sendBtn.disabled = false;
                sendBtn.innerHTML = originalText;
            }
        }

        async function verifyOTP() {
            const otp = document.getElementById('otpCode').value;
            const newPassword = document.getElementById('newPassword').value;
            
            clearErrors();
            let hasError = false;
            
            if (!otp || otp.length !== 6) {
                showError('otpError', 'Please enter a valid 6-digit OTP');
                hasError = true;
            }
            if (!newPassword || newPassword.length < 8) {
                showError('passwordError', 'Password must be at least 8 characters');
                hasError = true;
            }
            if (hasError) return;
            
            const verifyBtn = document.querySelector('#forgotStep2 .bg-primary');
            const originalText = verifyBtn.innerHTML;
            verifyBtn.disabled = true;
            verifyBtn.innerHTML = '<div class="loading-spinner rounded-full h-5 w-5 border-b-2 border-white mx-auto"></div>';
            
            try {
                const res = await fetch(`${API_BASE}/api/auth/reset-password`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email: currentForgotEmail, otp, newPassword })
                });
                
                const data = await res.json();
                
                if (res.ok) {
                    closeForgotModal();
                    document.getElementById('otpModal').classList.add('active');
                    document.getElementById('password').value = newPassword;
                } else {
                    showError('otpError', data.error || 'Invalid OTP');
                }
            } catch (error) {
                console.error('Error:', error);
                showError('otpError', 'Network error. Please try again.');
            } finally {
                verifyBtn.disabled = false;
                verifyBtn.innerHTML = originalText;
            }
        }

        // ========== OTHER FUNCTIONS ==========
        function showContactForm() {
            alert('Contact sales form coming soon!');
        }

        function showComingSoon(feature) {
            alert(`${feature} coming soon!`);
        }

        // Check account existence on email blur
        document.getElementById('email').addEventListener('blur', async function() {
            const email = this.value.trim();
            if (email) {
                const exists = await checkAccountExists(email);
                if (!exists) {
                    document.getElementById('accountNotExist').classList.remove('hidden');
                } else {
                    document.getElementById('accountNotExist').classList.add('hidden');
                }
            }
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            // Add click handlers for placeholder links
            document.querySelectorAll('a[href="/privacy"], a[href="/terms"], a[href="/cookies"], a[href="/security"], a[href="/solutions"], a[href="/docs"], a[href="/support"], a[href="/status"]').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    showComingSoon('This page');
                });
            });
            
            // Focus on email field
            document.getElementById('email').focus();
        });
    </script>
</body>
</html>